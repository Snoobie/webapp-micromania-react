// @flow
import Box from '../components/box';
import Heading from '../components/heading';
import Loading from '../components/loading';
import Page from '../components/page';
import Text from '../components/text';
import app from '../components/app';
import sitemap from '../lib/sitemap';
import { gql, graphql } from 'react-apollo';

// Types will be autogenerated after switch to Relay Modern.
type AllPostsPost = {
  __typename: string,
  createdAt: string,
  id: string,
  text: string,
  updatedAt: string,
};

const PostList = ({
  data: { allPosts },
}: {
  data: { allPosts: ?Array<AllPostsPost> },
}) => {
  if (!allPosts) return <Loading />;
  return (
    <Box>
      <Text>a</Text>
      <Text>b</Text>
    </Box>
  );
};

// {/* <Text>
//   {/* {allPosts.map(post => null)} */}
//   {JSON.stringify(allPosts, null, 2)}
// </Text>; */}

const PostListWithData = graphql(gql`
  query allPosts {
    allPosts {
      createdAt
      updatedAt
      id
      text
    }
  }
`)(PostList);

const Apollo = ({ intl }) =>
  <Page title={intl.formatMessage(sitemap.apollo.title)}>
    <Heading size={3}>
      {intl.formatMessage(sitemap.apollo.title)}
    </Heading>
    <Heading size={2}>Posts</Heading>
    <PostListWithData />
  </Page>;

export default app(Apollo);
